import trufflehog3
import os

# Path to the git repository on Putty
repo_path = '/var/lib/jenkins/workspace/Trufflehog_Job'

# Run trufflehog scan on the repository
scan_results = trufflehog3.scan(
    repo_path,
    branch='main', # You can specify a branch to scan if required
    exclude_paths=None, # Exclude any paths from the scan
    regex=None, # You can use a regex pattern to narrow down the search if required
    rules=None, # Custom rules to apply to the scan
    sensitivity=None # Level of sensitivity for the scan
)

# Output the scan results
print(scan_results)

# Write the scan results to a file
with open(os.path.join(repo_path, 'trufflehog_results.txt'), 'w') as f:
    f.write(str(scan_results))
